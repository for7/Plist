# 浏览器原理

> 对于写`浏览器原理`这个主题的是需要`勇气`的, 无奈它已经躺在写作清单里只好硬着头皮去梳理。涉及的概念很多，将是一个漫长的整理过程。

## 各大浏览器厂商时长占有率：



## 渲染流程

当用户在浏览器地址栏中输入网址时会发生以下事情：

1. 通过输入的网址提取域名
2. 将域名发到 DNS 服务器解析出资源所在服务器的IP地址
3. 通过IP地址下载html、css、javascript
4. 解析html，生成HTML tree
5. 解析css 生成CSS tree
6. 合并HTML tree、CSS tree 生成 Render tree
7.  布局阶段：根据 Render tree 计算每个节点元素的位置、尺寸等等几何属性
8. 绘制阶段： 几何属性确定后在屏幕上绘制节点的像素，比如绘制文字，颜色，图像，边框，阴影等等可视元素。
9. 合并图层：图层绘制完，浏览器会将其按照合理的顺序合并到同一图层，并显示在浏览器上。



需要注意的是，以上的流程并不是按顺序完整执行的。为了更好的用户体验，渲染引擎将会尽可能早的将内容呈现到屏幕上，并不会等到所有的html都解析完成之后再去构建和生成render树。它是解析完一部分内容就显示一部分内容，所以3~9的步骤会不断的重复。同时，可能还在通过网络下载其余内容。这个过程中除了 javascript 执行时会阻塞渲染外，其他的资源都是异步无阻塞的。

javascript下载完成后会立即执行 ， 通过 DOM API 和 CSSOM API 来操作 DOM Tree 和 CSS Rule Tree。

